function closeSidebar(){$(".sudoku-base-outer, .input-bar").css("filter","blur(0px)"),$(".sidebar-container, .sidebar").stop(),$(".sidebar").hasClass("right")?($(".sidebar-container").animate({opacity:0,right:"-100%",queue:!1},100),$(".sidebar").animate({right:"-100%"},300,function(){$(".sidebar-container").hide()})):($(".sidebar-container").animate({opacity:0,left:"-100%",queue:!1},100),$(".sidebar").animate({left:"-100%"},300,function(){$(".sidebar-container").hide()}))}function openSidebar(){$(".sudoku-base-outer, .input-bar").css("filter","blur(2px)"),$(".sidebar-container, .sidebar").stop(),$(".sidebar-container").show(),$(".sidebar").hasClass("right")?($(".sidebar-container").animate({opacity:1,right:0,queue:!1},100),$(".sidebar").animate({right:"0%"},300)):($(".sidebar-container").animate({opacity:1,left:0,queue:!1},100),$(".sidebar").animate({left:"0"},300))}$(document).ready(function(){$(".sidebar > .topbar > .collapse-btn").click(function(e){return e.preventDefault(),closeSidebar(),!1}),$(".trigger-sidebar-btn").click(function(e){return e.preventDefault(),openSidebar(),!1})}),function(e){var r=e.sudoku={};r.DIGITS="123456789";var n="ABCDEFGHI",a=r.DIGITS,u=null,t=null,o=null,i=null,s={easy:62,medium:53,hard:44,"very-hard":35,insane:26,inhuman:17};r.BLANK_CHAR=".",r.BLANK_BOARD=".................................................................................",r.generate=function(e,n){"string"!=typeof e&&void 0!==e||(e=s[e]||s.easy),e=r._force_range(e,82,17),n=n||!0;for(var a="",t=0;t<81;++t)a+=".";var o=r._get_candidates_map(a),i=r._shuffle(u);for(var l in i){var c=i[l],d=r._rand_range(o[c].length),h=o[c][d];if(!r._assign(o,c,h))break;var v=[];for(var l in u){1==o[c=u[l]].length&&v.push(o[c])}if(v.length>=e&&r._strip_dups(v).length>=8){var f="",_=[];for(var t in u){1==o[c=u[t]].length?(f+=o[c],_.push(t)):f+=r.BLANK_CHAR}var p=_.length;if(p>e){_=r._shuffle(_);for(t=0;t<p-e;++t){var k=parseInt(_[t]);f=f.substr(0,k)+r.BLANK_CHAR+f.substr(k+1)}}if(r.solve(f))return f}}return r.generate(e)},r.solve=function(e,n){var a=r.validate_board(e);if(!0!==a)throw a;var u=0;for(var t in e)e[t]!==r.BLANK_CHAR&&r._in(e[t],r.DIGITS)&&++u;if(u<17)throw"Too few givens. Minimum givens is 17";n=n||!1;var o=r._get_candidates_map(e),i=r._search(o,n);if(i){var s="";for(var l in i)s+=i[l];return s}return!1},r.get_candidates=function(e){var n=r.validate_board(e);if(!0!==n)throw n;var a=r._get_candidates_map(e);if(!a)return!1;var u=[],t=[],o=0;for(var i in a){var s=a[i];t.push(s),o%9==8&&(u.push(t),t=[]),++o}return u},r._get_candidates_map=function(e){var n=r.validate_board(e);if(!0!==n)throw n;var a={},t=r._get_square_vals_map(e);for(var o in u)a[u[o]]=r.DIGITS;for(var i in t){var s=t[i];if(r._in(s,r.DIGITS))if(!r._assign(a,i,s))return!1}return a},r._search=function(e,n){if(!e)return!1;n=n||!1;var a=0;for(var t in u){(l=e[s=u[t]].length)>a&&(a=l,s)}if(1===a)return e;var o=10,i=null;for(t in u){var s,l;(l=e[s=u[t]].length)<o&&l>1&&(o=l,i=s)}var c=e[i];if(n)for(d=c.length-1;d>=0;--d){v=c[d],f=JSON.parse(JSON.stringify(e));if(h=r._search(r._assign(f,i,v),n))return h}else for(var d in c){var h,v=c[d],f=JSON.parse(JSON.stringify(e));if(h=r._search(r._assign(f,i,v)))return h}return!1},r._assign=function(e,n,a){var u=e[n].replace(a,"");for(var t in u){var o=u[t];if(!r._eliminate(e,n,o))return!1}return e},r._eliminate=function(e,n,a){if(!r._in(a,e[n]))return e;e[n]=e[n].replace(a,"");var u=e[n].length;if(1===u){var t=e[n];for(var s in i[n]){var l=i[n][s];if(!r._eliminate(e,l,t))return!1}}if(0===u)return!1;for(var c in o[n]){var d=o[n][c],h=[];for(var v in d){var f=d[v];r._in(a,e[f])&&h.push(f)}if(0===h.length)return!1;if(1===h.length&&!r._assign(e,h[0],a))return!1}return e},r._get_square_vals_map=function(e){var r={};if(e.length!=u.length)throw"Board/squares length mismatch.";for(var n in u)r[u[n]]=e[n];return r},r._get_square_units_map=function(e,r){var n={};for(var a in e){var u=e[a],t=[];for(var o in r){var i=r[o];-1!==i.indexOf(u)&&t.push(i)}n[u]=t}return n},r._get_square_peers_map=function(e,r){var n={};for(var a in e){var u=e[a],t=r[u],o=[];for(var i in t){var s=t[i];for(var l in s){var c=s[l];-1===o.indexOf(c)&&c!==u&&o.push(c)}}n[u]=o}return n},r._get_all_units=function(e,n){var a=[];for(var u in e)a.push(r._cross(e[u],n));for(var t in n)a.push(r._cross(e,n[t]));var o=["ABC","DEF","GHI"],i=["123","456","789"];for(var s in o)for(var l in i)a.push(r._cross(o[s],i[l]));return a},r.board_string_to_grid=function(e){var r=[],n=[];for(var a in e)n.push(e[a]),a%9==8&&(r.push(n),n=[]);return r},r.board_grid_to_string=function(e){for(var r="",n=0;n<9;++n)for(var a=0;a<9;++a)r+=e[n][a];return r},r.print_board=function(e){var n=r.validate_board(e);if(!0!==n)throw n;var a="";for(var u in e){a+=e[u]+" ",u%3==2&&(a+="  "),u%9==8&&(a+="\n"),u%27==26&&(a+="\n")}console.log(a)},r.validate_board=function(e){if(!e)return"Empty board";if(81!==e.length)return"Invalid board size. Board must be exactly 81 squares.";for(var n in e)if(!r._in(e[n],r.DIGITS)&&e[n]!==r.BLANK_CHAR)return"Invalid board character encountered at index "+n+": "+e[n];return!0},r._cross=function(e,r){var n=[];for(var a in e)for(var u in r)n.push(e[a]+r[u]);return n},r._in=function(e,r){return-1!==r.indexOf(e)},r._first_true=function(e){for(var r in e)if(e[r])return e[r];return!1},r._shuffle=function(e){for(var n=[],a=0;a<e.length;++a)n.push(!1);for(var a in e){for(var u=r._rand_range(e.length);n[u];)u=u+1>e.length-1?0:u+1;n[u]=e[a]}return n},r._rand_range=function(e,r){if(r=r||0,e)return Math.floor(Math.random()*(e-r))+r;throw"Range undefined"},r._strip_dups=function(e){var r=[],n={};for(var a in e){var u=e[a];n[u]||(r.push(u),n[u]=!0)}return r},r._force_range=function(e,r,n){return(e=e||0)<(n=n||0)?n:e>r?r:e},u=r._cross(n,a),t=r._get_all_units(n,a),o=r._get_square_units_map(u,t),i=r._get_square_peers_map(u,o)}(this),function(e){var r=e.sudokuInterface={};function n(e){$(".sudoku-cell.selected").removeClass("selected");l(e);if(null!==r.active_sudoku_node&&e.hasClass("active")&&r.active_sudoku_node.attr("s_index")==e.attr("s_index"))a();else{$(".sudoku-cell").removeClass("active"),r.active_sudoku_node=e,e.addClass("selected");var n=function(e){var r=l(e),n=[],a=[],u=e.parent(),t=l(u),o=u.parent();1==t.row?(a.push(o.children(".sudoku-base-cell:nth-child(1)")),a.push(o.children(".sudoku-base-cell:nth-child(2)")),a.push(o.children(".sudoku-base-cell:nth-child(3)"))):2==t.row?(a.push(o.children(".sudoku-base-cell:nth-child(4)")),a.push(o.children(".sudoku-base-cell:nth-child(5)")),a.push(o.children(".sudoku-base-cell:nth-child(6)"))):(a.push(o.children(".sudoku-base-cell:nth-child(7)")),a.push(o.children(".sudoku-base-cell:nth-child(8)")),a.push(o.children(".sudoku-base-cell:nth-child(9)")));for(var i in a)1==r.row?(n.push(a[i].children(".sudoku-cell:nth-child(1)")),n.push(a[i].children(".sudoku-cell:nth-child(2)")),n.push(a[i].children(".sudoku-cell:nth-child(3)"))):2==r.row?(n.push(a[i].children(".sudoku-cell:nth-child(4)")),n.push(a[i].children(".sudoku-cell:nth-child(5)")),n.push(a[i].children(".sudoku-cell:nth-child(6)"))):(n.push(a[i].children(".sudoku-cell:nth-child(7)")),n.push(a[i].children(".sudoku-cell:nth-child(8)")),n.push(a[i].children(".sudoku-cell:nth-child(9)")));return n}(e).concat(function(e){var r=l(e),n=[],a=[],u=e.parent(),t=l(u),o=u.parent();1==t.column?(a.push(o.children(".sudoku-base-cell:nth-child(1)")),a.push(o.children(".sudoku-base-cell:nth-child(4)")),a.push(o.children(".sudoku-base-cell:nth-child(7)"))):2==t.column?(a.push(o.children(".sudoku-base-cell:nth-child(2)")),a.push(o.children(".sudoku-base-cell:nth-child(5)")),a.push(o.children(".sudoku-base-cell:nth-child(8)"))):(a.push(o.children(".sudoku-base-cell:nth-child(3)")),a.push(o.children(".sudoku-base-cell:nth-child(6)")),a.push(o.children(".sudoku-base-cell:nth-child(9)")));for(var i in a)1==r.column?(n.push(a[i].children(".sudoku-cell:nth-child(1)")),n.push(a[i].children(".sudoku-cell:nth-child(4)")),n.push(a[i].children(".sudoku-cell:nth-child(7)"))):2==r.column?(n.push(a[i].children(".sudoku-cell:nth-child(2)")),n.push(a[i].children(".sudoku-cell:nth-child(5)")),n.push(a[i].children(".sudoku-cell:nth-child(8)"))):(n.push(a[i].children(".sudoku-cell:nth-child(3)")),n.push(a[i].children(".sudoku-cell:nth-child(6)")),n.push(a[i].children(".sudoku-cell:nth-child(9)")));return n}(e)).concat(function(e){return $.map(e.parent().children(".sudoku-cell"),function(e){return $(e)})}(e));for(var u in n)n[u].addClass("active")}}function a(){$(".sudoku-cell").removeClass("active selected"),r.active_sudoku_node=null}function u(e){void 0===e&&(e=o()),$(".sudoku-cell.duplicate").removeClass("duplicate");for(var r=0;r<e.length;r++)e[r].addClass("duplicate");return e}function t(){$(".sudoku-cell").children("span").remove(),$(".sudoku-cell").removeClass("duplicate user locked")}function o(e){var n={};function a(e){void 0===n[e.attr("s_index")]&&(n[e.attr("s_index")]=e)}for(var u in console.log("Initial",n.length),r.sudoku_master_array)for(var t=r.sudoku_master_array[u].map(function(e,r){return{value:e,node:$(`.sudoku-cell[row="${u}"][column="${r}"]`)}}).sort(function(e,r){return e.value-r.value}),o=0;o<t.length;o++)if(0!==o&&t[o].value==t[o-1].value&&"."!==t[o].value){if(e)return!0;console.log("FOUND AT ROW",t[o].value),a(t[o].node),a(t[o-1].node)}for(var i=0;i<9;i++){var s=r.sudoku_master_array.map(function(e,r){return{value:e[i],node:$(`.sudoku-cell[row="${r}"][column="${i}"]`)}}).sort(function(e,r){return e.value-r.value});for(o=0;o<s.length;o++)if(0!==o&&s[o].value==s[o-1].value&&"."!==s[o].value){if(e)return!0;console.log("FOUND AT COLUMN",s[o].value),a(s[o].node),a(s[o-1].node)}}for(var l in r.sudoku_block_array){var c=r.sudoku_block_array[l].map(function(e,r){return{value:e,node:$(`.sudoku-cell[block="${l}"][cell="${r}"]`)}}).sort(function(e,r){return e.value-r.value});for(o=0;o<c.length;o++)if(0!==o&&c[o].value==c[o-1].value&&"."!==c[o].value){if(e)return!0;a(c[o].node),a(c[o-1].node)}}return!e&&Object.values(n)}function i(e,n){r.sudoku_master_string[parseInt(e.attr("s_index"))]=n,r.sudoku_master_array[parseInt(e.attr("row"))][parseInt(e.attr("column"))]=n,r.sudoku_block_array[parseInt(e.attr("block"))][parseInt(e.attr("cell"))]=n}r.initializeBoard=function(){r.history=[],r.sudoku_master_string_origin,r.sudoku_master_string,r.sudoku_master_array,r.sudoku_block_array,r.active_sudoku_node,function(){for(var e=0,r=0,n=0,a=0;a<3;a++)for(var u=3*a,t=3*(a+1),o=0;o<3;o++)for(var i=u;i<t;i++){var s=$(".sudoku-base").children(".sudoku-base-cell").eq(i);s.children(".sudoku-cell").eq(3*o).attr("s_index",e++).attr("row",r).attr("column",n++),s.children(".sudoku-cell").eq(3*o+1).attr("s_index",e++).attr("row",r).attr("column",n++),s.children(".sudoku-cell").eq(3*o+2).attr("s_index",e++).attr("row",r).attr("column",n++),n>=9&&(r++,n=0)}$(".sudoku-base-cell").each(function(){var e=$(this).index();$(this).children(".sudoku-cell").each(function(){$(this).attr("block",e).attr("cell",$(this).index())})})}(),$(".tool-bar > a#erase").click(function(e){return e.preventDefault(),null!==r.active_sudoku_node&&0==r.active_sudoku_node.hasClass("locked")&&clearNode(r.active_sudoku_node),!1}),$(".tool-bar > a#undo").click(function(e){return e.preventDefault(),r.undo(),!1}),$(".tool-bar > a#hint").click(function(e){return e.preventDefault(),r.getHint(),!1}),$(".number-bar > a").click(function(e){return e.preventDefault(),null!==r.active_sudoku_node&&0==r.active_sudoku_node.hasClass("locked")&&r.setNode(r.active_sudoku_node,$(this).text()),!1}),$(".sudoku-cell").click(function(e){return e.preventDefault(),n($(this)),!1}),$(".sidebar > button#restart").click(function(e){e.preventDefault(),closeSidebar(),restartGame()}),$(".sidebar > button#solve").click(function(e){e.preventDefault(),closeSidebar(),solvePuzzle()})},r.initializeBoard(),r.restartGame=function(){r.startSudokuGame(r.sudoku_master_string_origin,!0)},r.startSudokuGame=function(e,n){var u;switch(t(),e){case"easy":case"medium":case"hard":case"very-hard":case"insane":case"inhuman":u=sudoku.generate(e);break;default:u=e}console.log(u),r.sudoku_master_string_origin=u+"",r.history=[],r.sudoku_master_string=u+"",r.sudoku_master_array=c(u,"rows"),r.sudoku_block_array=c(u,"blocks"),1==!n&&(r.active_sudoku_node=null),d(r.sudoku_block_array),a()},r.solvePuzzle=function(){t(),d(c(sudoku.solve(r.sudoku_master_string_origin),"blocks"))},r.getHint=function(){var e=r.getCurrentSudokuString(),a=sudoku.solve(r.sudoku_master_string_origin);if(0!=a){var u;if(null!==r.active_sudoku_node){var t=r.active_sudoku_node.attr("s_index");if("."!==r.sudoku_master_string_origin[t])return void console.log("Cannot use HINT for pre-filled cell");if(u={index:t,value:a[t]},console.log("REE"),console.log(e[t],a[t]),"."!==e[t]&&e[t]==a[t])return void console.log("HINT was used on a solved cell")}else{for(var o=[],i=0;i<a.length;i++)a[i]!==e[i]&&o.push({index:i,value:a[i]});u=o[Math.floor(Math.random()*o.length)],n($(`.sudoku-cell[s_index="${u.index}"]`))}console.log("Hint",u),r.setNode($(`.sudoku-cell[s_index="${u.index}"]`),u.value)}else console.log("No Solution")},r.checkSudokuSolution=function(e){if(0==function(e){var n=[];for(var a in r.sudoku_master_array)for(var u=r.sudoku_master_array[a].map(function(e,r){return{value:e,node:$(`.sudoku-cell[row="${a}"][column="${r}"]`)}}),t=0;t<u.length;t++)if("."==u[t].value){if(e)return!0;n.push(u[t].node)}return!e&&n}(!0)){if(0==(e=e||o()).length)return console.log("No Duplicate Nodes"),!0;console.log("Duplicate Nodes Found")}else console.log("Empty Nodes Found");return!1},r.setNode=function(e,n){var a=e.children("span");if(0==a.length)e.addClass("user"),a=$("<span>").appendTo(e);else if(a.text()==n)return void clearNode(e);var t=""==a.text().replace(/ /g,"")?null:a.text();a.text(n),i(e,n),r.history.push({node:e,previous_value:t,value:n});u();r.checkSudokuSolution()},clearNode=function(e){var n=e.children("span");i(e,"."),r.history.push({node:e,previous_value:n.text(),value:null}),n.remove(),u()},r.undo=function(){if(r.history.length>0){var e=r.history.pop(),n=e.node.children("span");console.log("Undo",e),null==e.previous_value?(0!==n.length&&n.remove(),i(e.node,".")):(0==n.length?n=$("<span>").text(e.previous_value).appendTo(e.node):n.text(e.previous_value),i(e.node,e.previous_value)),u()}};var s={};function l(e,r){if("rows_array"==r)return{row:parseInt(e.attr("row")),column:parseInt(e.attr("column"))};if("string"==r)return e.attr("s_index");if(e.hasClass("sudoku-cell")&&void 0!==s[e.attr("s_index")])return s[e.attr("s_index")];var n=e.index(),a={},u=n%3;return 0==u?a.column=1:1==u?a.column=2:2==u?a.column=3:(console.log("WARNING: Invalid node column calculation",e),a.column=null),n<3?a.row=1:n<6?a.row=2:n<9?a.row=3:(console.log("WARNING: Invalid node row calculation",e),a.row=null),e.hasClass("sudoku-cell")&&(s[e.attr("s_index")]=a),a}function c(e,r){if("blocks"==r){for(var n=[],a=0;a<27;a++){var u=[];u.push(e[3*a]),u.push(e[3*a+1]),u.push(e[3*a+2]),n.push(u)}var t=[];for(a=0;a<3;a++)for(var o=0;o<3;o++){var i;i=n[9*a+o].concat(n[9*a+(o+3)]).concat(n[9*a+(o+6)]),t.push(i)}return t}if("rows"==r){t=[];for(var s=0;s<9;s++)t.push(e.substring(9*s,9*(s+1)).split(""));return t}}function d(e){for(var r in e)for(var n in e[r]){var a=e[r][n];"."!==a&&$(".sudoku-base > .sudoku-base-cell").eq(r).children(".sudoku-cell").eq(n).addClass("locked").append($("<span>").text(a))}}function h(e){return 0==e.children("span").length?".":e.children("span").text()}r.getCurrentSudokuString=function(e){var n="";if(e)for(var a=0;a<3;a++)for(var u=3*a,t=3*(a+1),o=0;o<3;o++)for(var i=u;i<t;i++){var s=$(".sudoku-base").children(".sudoku-base-cell").eq(i);n+=h(s.children(".sudoku-cell").eq(3*o)),n+=h(s.children(".sudoku-cell").eq(3*o+1)),n+=h(s.children(".sudoku-cell").eq(3*o+2))}else for(var l in r.sudoku_master_array)n+=r.sudoku_master_array[l].join("");return n}}(this);var current_view=0;function changeView(e){var r=$(`.view[view="${current_view}"]`),n=$(`.view[view="${e}"]`);r.stop(),n.stop(),r.animate({left:e>current_view?"-100vw":"100vw"},{duration:50,queue:!1}),n.animate({left:0},{duration:250}),current_view=e}var games={};function generateGames(){var e=["easy","medium","hard","very-hard","insane","inhuman"];for(var r in e){for(var n=e[r],a=[],u=0;u<40;u++)a.push(sudoku.generate(n));games[n]=a}console.log("Games",games)}$(document).ready(function(){$(".menu-container > .btn").click(function(e){var r=$(this).attr("difficulty");console.log("Requested a",r,"game"),$(".puzzles-container > .inner").empty(),$(".puzzles-container > h3").text(`${r} Puzzles`);for(var n=0;n<games[r].length;n++){var a=$("<button>").text(`Puzzle ${n+1}`).addClass("btn btn-white btn-block").attr("mode",r).attr("puzzle",n);a.click(function(e){var r=$(this).attr("mode"),n=$(this).attr("puzzle"),a=games[r][n];sudokuInterface.startSudokuGame(a),changeView(2)}),$(".puzzles-container > .inner").append(a)}changeView(1)}),generateGames(),$(".topbar > .return-btn").click(function(e){changeView(parseInt($(this).attr("gotoview")))})});